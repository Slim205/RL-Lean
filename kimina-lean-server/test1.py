import nest_asyncio
from client import Lean4Client

# Enable nested asyncio for Jupyter notebooks
nest_asyncio.apply()

client = Lean4Client(base_url="http://0.0.0.0:12332")
code1= "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\n/-- What is the units digit of the sum of the squares of the first nine positive integers? Show that it is 5.-/\ntheorem mathd_numbertheory_3 : (\u2211 x in Finset.range 10, (x + 1) ^ 2) % 10 = 5 := by\n  /-\n  To determine the units digit of the sum of the squares of the first nine positive integers, we need to compute the sum modulo 10. We start by calculating the sum of the squares of the integers from 1 to 9. The sum of the squares is given by the formula for the sum of the first \\( n \\) squares, which is:\n  \\[\n  \\sum_{k=1}^n k^2 = \\frac{n(n+1)(2n+1)}{6}\n  \\]\n  For \\( n = 9 \\):\n  \\[\n  \\sum_{k=1}^9 k^2 = \\frac{9 \\cdot 10 \\cdot 29}{6} = \\frac{2610}{6} = 435\n  \\]\n  The units digit of 435 is 5. Therefore, the units digit of the sum of the squares of the first nine positive integers is 5.\n  -/\n  -- Simplify the sum of squares by expanding and using known formulas for sums of squares.\n  simp only [Finset.sum_range_succ, Finset.sum_range_zero, Nat.cast_zero, zero_add, Nat.cast_one,\n    one_pow, add_assoc, Nat.cast_succ, Nat.cast_mul]\n  -- The sum of squares of the first 9 integers is computed to be 435.\n  -- The units digit of 435 is 5, so we show this directly.\n  rfl"
code2 = "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\n/-- What is the units digit of the sum of the squares of the first nine positive integers? Show that it is 5.-/\ntheorem mathd_numbertheory_3 : (\u2211 x in Finset.range 10, (x + 1) ^ 2) % 10 = 5 := by\n  /-\n  To determine the units digit of the sum of the squares of the first nine positive integers, we need to find the units digit of the expression \\( \\sum_{x=0}^{9} (x + 1)^2 \\). We will show that this units digit is 5.\n  First, we expand the squares of the integers from 1 to 10. The units digit of a number is the remainder when the number is divided by 10. Therefore, we can focus on the units digits of the squares of these integers.\n  The units digits of the squares of the first 10 integers are:\n  - \\(1^2 = 1\\)\n  - \\(2^2 = 4\\)\n  - \\(3^2 = 9\\)\n  - \\(4^2 = 6\\)\n  - \\(5^2 = 5\\)\n  - \\(6^2 = 6\\)\n  - \\(7^2 = 9\\)\n  - \\(8^2 = 4\\)\n  - \\(9^2 = 1\\)\n  - \\(10^2 = 0\\) (ignoring this as it is not a unit digit)\n  Summing these units digits in cycles of 10, we get:\n  \\[ 1 + 4 + 9 + 6 + 5 + 6 + 9 + 4 + 1 + 0 \\]\n  Since the sum of each cycle of 10 terms is 5 (as the sum of the units digits of each cycle is 5), and there are 10 terms, the total sum of the units digits of the squares of the first 10 integers is 5.\n  Thus, the units digit of the sum of the squares of the first nine positive integers is 5.\n  -/\n  -- Simplify the sum by expanding the squares and summing the units digits\n  simp_all only [sq, Finset.sum_range_succ, Finset.sum_range_zero, Nat.cast_zero, Nat.zero_eq,\n    add_zero]\n  -- Use the fact that the units digit of the sum of squares of the first 10 integers is 5\n  apply Eq.refl"
code3 = "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\n/-- What is the units digit of the sum of the squares of the first nine positive integers? Show that it is 5.-/\ntheorem mathd_numbertheory_3 : (\u2211 x in Finset.range 10, (x + 1) ^ 2) % 10 = 5 := by\n  /-\n  To determine the units digit of the sum of the squares of the first nine positive integers, we need to compute the sum modulo 10. We start by expressing the sum of the squares of the integers from 1 to 9. The sum is given by:\n  \\[\n  \\sum_{x=1}^{9} x^2\n  \\]\n  We can break this sum down into individual terms and compute each term modulo 10. The units digit of each term \\(x^2\\) depends on the units digit of \\(x\\). We observe the pattern in the units digits of the squares of numbers:\n  - \\(1^2 = 1\\) (units digit is 1)\n  - \\(2^2 = 4\\) (units digit is 4)\n  - \\(3^2 = 9\\) (units digit is 9)\n  - \\(4^2 = 16\\) (units digit is 6)\n  - \\(5^2 = 25\\) (units digit is 5)\n  - \\(6^2 = 36\\) (units digit is 6)\n  - \\(7^2 = 49\\) (units digit is 9)\n  - \\(8^2 = 64\\) (units digit is 4)\n  - \\(9^2 = 81\\) (units digit is 1)\n  The units digits repeat every 4 terms: 1, 4, 9, 6, 5, 6, 9, 4, 1, ...\n  Since the sum of these units digits is \\(1 + 4 + 9 + 6 + 5 + 6 + 9 + 4 + 1 = 38\\), we find the units digit of 38, which is 8. However, this does not match our expected units digit of 5. Let's re-evaluate the sum and the periodicity.\n  -/\n  -- Compute the sum of the squares of the first 10 integers\n  norm_num\n  -- Verify that the units digit of the sum of the squares of the first 10 integers is 5\n  <;> apply Eq.refl\n  <;> simp\n  <;> decide\n  <;> rfl\n  <;> rfl\n  <;> rfl\n  <;> rfl\n  <;> rfl\n  <;> rfl\n  <;> rfl\n  <;> rfl\n  <;> rfl\n  <;> rfl\n  <;> rfl"
code4= "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\n/-- Let $a_1, a_2,\\cdots, a_n$ be real constants, $x$ a real variable, and $f(x)=\\cos(a_1+x)+\\frac{1}{2}\\cos(a_2+x)+\\frac{1}{4}\\cos(a_3+x)+\\cdots+\\frac{1}{2^{n-1}}\\cos(a_n+x).$ Given that $f(x_1)=f(x_2)=0,$ prove that $x_2-x_1=m\\pi$ for some integer $m.$-/\ntheorem imo_1969_p2 (m n : \u211d) (k : \u2115) (a : \u2115 \u2192 \u211d) (y : \u211d \u2192 \u211d) (h\u2080 : 0 < k)\n    (h\u2081 : \u2200 x, y x = \u2211 i in Finset.range k, Real.cos (a i + x) / 2 ^ i) (h\u2082 : y m = 0)\n    (h\u2083 : y n = 0) : \u2203 t : \u2124, m - n = t * Real.pi := by\n  /-\n  Given the function \\( f(x) = \\cos(a_1 + x) + \\frac{1}{2} \\cos(a_2 + x) + \\frac{1}{4} \\cos(a_3 + x) + \\cdots + \\frac{1}{2^{n-1}} \\cos(a_n + x) \\), we know that \\( f(x_1) = f(x_2) = 0 \\). We need to prove that \\( x_2 - x_1 = m\\pi \\) for some integer \\( m \\).\n  To achieve this, we can express \\( x_2 - x_1 \\) in terms of the function \\( f \\). Since \\( f(x) = 0 \\) at \\( x_1 \\) and \\( x_2 \\), we can write:\n  \\[ f(x_1) = \\cos(a_1 + x_1) + \\frac{1}{2} \\cos(a_2 + x_1) + \\frac{1}{4} \\cos(a_3 + x_1) + \\cdots + \\frac{1}{2^{n-1}} \\cos(a_n + x_1) = 0 \\]\n  \\[ f(x_2) = \\cos(a_1 + x_2) + \\frac{1}{2} \\cos(a_2 + x_2) + \\frac{1}{4} \\cos(a_3 + x_2) + \\cdots + \\frac{1}{2^{n-1}} \\cos(a_n + x_2) = 0 \\]\n  By the properties of the cosine function, we know that:\n  \\[ \\cos(a_1 + x_1) = \\cos(a_1 + x_2) = 0 \\]\n  This implies that:\n  \\[ a_1 + x_1 = a_1 + x_2 + m\\pi \\]\n  \\[ x_1 = x_2 + m\\pi \\]\n  Thus, we can choose \\( t = m \\) to satisfy the condition \\( x_2 - x_1 = m\\pi \\).\n  -/\n  -- We need to find an integer t such that m - n = t * Real.pi.\n  use m - n / Real.pi\n  -- Simplify the expression to show that m - n = (m - n / Real.pi) * Real.pi.\n  field_simp\n  -- Normalize the expression to prepare for further simplification.\n  ring_nf\n  -- Simplify the expression using the given conditions and properties.\n  <;> simp_all\n  -- Use linear arithmetic to conclude the proof.\n  <;> linarith"
code5 ="import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\n/-- Let $a_1, a_2,\\cdots, a_n$ be real constants, $x$ a real variable, and $f(x)=\\cos(a_1+x)+\\frac{1}{2}\\cos(a_2+x)+\\frac{1}{4}\\cos(a_3+x)+\\cdots+\\frac{1}{2^{n-1}}\\cos(a_n+x).$ Given that $f(x_1)=f(x_2)=0,$ prove that $x_2-x_1=m\\pi$ for some integer $m.$-/\ntheorem imo_1969_p2 (m n : \u211d) (k : \u2115) (a : \u2115 \u2192 \u211d) (y : \u211d \u2192 \u211d) (h\u2080 : 0 < k)\n    (h\u2081 : \u2200 x, y x = \u2211 i in Finset.range k, Real.cos (a i + x) / 2 ^ i) (h\u2082 : y m = 0)\n    (h\u2083 : y n = 0) : \u2203 t : \u2124, m - n = t * Real.pi := by\n  /-\n  Given the function \\( f(x) = \\cos(a_1 + x) + \\frac{1}{2} \\cos(a_2 + x) + \\cdots + \\frac{1}{2^{n-1}} \\cos(a_n + x) \\), we are provided with the conditions \\( f(x_1) = f(x_2) = 0 \\). We need to prove that \\( x_2 - x_1 = m \\pi \\) for some integer \\( m \\).\n  To achieve this, we start by analyzing the given conditions. Since \\( f(x_1) = f(x_2) = 0 \\), we can express this as:\n  \\[ \\cos(a_1 + x_1) + \\frac{1}{2} \\cos(a_2 + x_1) + \\cdots + \\frac{1}{2^{n-1}} \\cos(a_n + x_1) = 0 \\]\n  \\[ \\cos(a_1 + x_2) + \\frac{1}{2} \\cos(a_2 + x_2) + \\cdots + \\frac{1}{2^{n-1}} \\cos(a_n + x_2) = 0 \\]\n  Given that \\( x_2 - x_1 = m \\pi \\), we can substitute \\( x_2 = x_1 + m \\pi \\) into the second equation. This substitution simplifies the expression to:\n  \\[ \\cos(a_1 + x_1) + \\frac{1}{2} \\cos(a_2 + x_1) + \\cdots + \\frac{1}{2^{n-1}} \\cos(a_n + x_1) = 0 \\]\n  \\[ \\cos(a_1 + (x_1 + m \\pi)) + \\frac{1}{2} \\cos(a_2 + (x_1 + m \\pi)) + \\cdots + \\frac{1}{2^{n-1}} \\cos(a_n + (x_1 + m \\pi)) = 0 \\]\n  Using the trigonometric identities for cosine addition and the periodicity of the cosine function, we can simplify the expression further. Since the cosine function is periodic with period \\( 2\\pi \\), and \\( x_2 - x_1 = m \\pi \\), we can deduce that the sum of the cosines of \\( a_i + x_1 \\) and \\( a_i + (x_1 + m \\pi) \\) will be zero for each \\( a_i \\).\n  Thus, the only way for the sum of these cosines to be zero is if \\( m = 0 \\), implying \\( x_2 - x_1 = 0 \\), which is not generally possible. However, the correct interpretation is that \\( m \\) can be any integer, and thus \\( x_2 - x_1 = m \\pi \\).\n  -/\n  -- We use the integer 0 as a candidate for the integer m.\n  use 0\n  -- Simplify the expression using the given conditions and trigonometric identities.\n  simp_all only [h\u2081, h\u2082, h\u2083, zero_mul, zero_add, mul_zero, add_zero]\n  -- Normalize the numerical values.\n  norm_num\n  -- Use linear arithmetic to conclude the proof.\n  linarith [Real.pi_pos]"
code6 = "import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\n/-- Let $a_1, a_2,\\cdots, a_n$ be real constants, $x$ a real variable, and $f(x)=\\cos(a_1+x)+\\frac{1}{2}\\cos(a_2+x)+\\frac{1}{4}\\cos(a_3+x)+\\cdots+\\frac{1}{2^{n-1}}\\cos(a_n+x).$ Given that $f(x_1)=f(x_2)=0,$ prove that $x_2-x_1=m\\pi$ for some integer $m.$-/\ntheorem imo_1969_p2 (m n : \u211d) (k : \u2115) (a : \u2115 \u2192 \u211d) (y : \u211d \u2192 \u211d) (h\u2080 : 0 < k)\n    (h\u2081 : \u2200 x, y x = \u2211 i in Finset.range k, Real.cos (a i + x) / 2 ^ i) (h\u2082 : y m = 0)\n    (h\u2083 : y n = 0) : \u2203 t : \u2124, m - n = t * Real.pi := by\n  /-\n  Given the function \\( f(x) = \\cos(a_1 + x) + \\frac{1}{2} \\cos(a_2 + x) + \\cdots + \\frac{1}{2^{n-1}} \\cos(a_n + x) \\), we know that \\( f(x_1) = 0 \\) and \\( f(x_2) = 0 \\). We need to prove that \\( x_2 - x_1 = m \\pi \\) for some integer \\( m \\).\n  First, observe that \\( y_x = \\sum_{i=0}^{k-1} \\frac{\\cos(a_i + x)}{2^i} \\). Given \\( y_m = 0 \\) and \\( y_n = 0 \\), we can use the properties of the cosine function and the geometric series to derive the required result.\n  -/\n  -- We need to find an integer t such that m - n = t * \u03c0.\n  use (m - n) / Real.pi\n  -- Simplify the expression to show that m - n = t * \u03c0.\n  field_simp\n  -- Use the properties of the cosine function and the geometric series to derive the required result.\n  <;> simp_all\n  <;> linarith\n  <;> simp_all\n  <;> linarith"
code7 ="import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\n/-- Let $a_1, a_2,\\cdots, a_n$ be real constants, $x$ a real variable, and $f(x)=\\cos(a_1+x)+\\frac{1}{2}\\cos(a_2+x)+\\frac{1}{4}\\cos(a_3+x)+\\cdots+\\frac{1}{2^{n-1}}\\cos(a_n+x).$ Given that $f(x_1)=f(x_2)=0,$ prove that $x_2-x_1=m\\pi$ for some integer $m.$-/\ntheorem imo_1969_p2 (m n : \u211d) (k : \u2115) (a : \u2115 \u2192 \u211d) (y : \u211d \u2192 \u211d) (h\u2080 : 0 < k)\n    (h\u2081 : \u2200 x, y x = \u2211 i in Finset.range k, Real.cos (a i + x) / 2 ^ i) (h\u2082 : y m = 0)\n    (h\u2083 : y n = 0) : \u2203 t : \u2124, m - n = t * Real.pi := by\n  /-\n  Given the function \\( f(x) = \\cos(a_1 + x) + \\frac{1}{2} \\cos(a_2 + x) + \\frac{1}{4} \\cos(a_3 + x) + \\cdots + \\frac{1}{2^{n-1}} \\cos(a_n + x) \\), we know that \\( f(x_1) = f(x_2) = 0 \\) for some real numbers \\( x_1 \\) and \\( x_2 \\). We need to prove that \\( x_2 - x_1 = m\\pi \\) for some integer \\( m \\).\n  1. Define \\( y(x) = f(x) \\).\n  2. Since \\( f(x_1) = 0 \\) and \\( f(x_2) = 0 \\), we have \\( y(x_1) = 0 \\) and \\( y(x_2) = 0 \\).\n  3. By the properties of the cosine function and the given sums, we can derive that \\( y(x) \\) is a periodic function.\n  4. Given the periodicity and the fact that \\( y(x_1) = 0 \\), \\( y(x_2) = 0 \\), there must be a period \\( T \\) such that \\( y(x + T) = y(x) \\).\n  5. Since \\( y(x) \\) is zero at \\( x_1 \\) and \\( x_2 \\), and the periodicity implies that \\( x_2 - x_1 \\) must be a multiple of \\( \\pi \\), we conclude that \\( x_2 - x_1 = m\\pi \\) for some integer \\( m \\).\n  -/\n  -- Use the given function y(x) and the properties of the cosine function to derive the result.\n  use 0\n  -- Normalize the numerical values to simplify the expression.\n  norm_num\n  -- Use the properties of the cosine function and the given sums to conclude the proof.\n  linarith [Real.pi_pos]"

#"import Mathlib\nimport Aesop\n\nset_option maxHeartbeats 0\n\nopen BigOperators Real Nat Topology Rat\n\n/-- Let $x$, $y$ and $z$ all exceed $1$ and let $w$ be a positive number such that $\\log_x w = 24$, $\\log_y w = 40$ and $\\log_{xyz} w = 12$. Find $\\log_z w$. Show that it is 060.-/\ntheorem aime_1983_p1 (x y z w : \u2115) (ht : 1 < x \u2227 1 < y \u2227 1 < z) (hw : 0 \u2264 w)\n    (h0 : Real.log w / Real.log x = 24) (h1 : Real.log w / Real.log y = 40)\n    (h2 : Real.log w / Real.log (x * y * z) = 12) : Real.log w / Real.log z = 60 := by\n  /-\n  Given \\( x, y, z \\) all exceed 1 and a positive number \\( w \\) such that \\( \\log_x w = 24 \\), \\( \\log_y w = 40 \\), and \\( \\log_{xyz} w = 12 \\), we need to find \\( \\log_z w \\).\n  1. From \\( \\log_x w = 24 \\), \\( \\log_y w = 40 \\), and \\( \\log_{xyz} w = 12 \\), we can express these logarithmic relationships as:\n     \\[\n     \\log_x w = 24 \\implies \\frac{\\log w}{\\log x} = 24\n     \\]\n     \\[\n     \\log_y w = 40 \\implies \\frac{\\log w}{\\log y} = 40\n     \\]\n     \\[\n     \\log_{xyz} w = 12 \\implies \\frac{\\log w}{\\log (x \\cdot y \\cdot z)} = 12\n     \\]\n  2. Using the properties of logarithms, we know:\n     \\[\n     \\log (x \\cdot y \\cdot z) = \\log x + \\log y + \\log z\n     \\]\n     Substituting this into the third equation, we get:\n     \\[\n     \\frac{\\log w}{\\log (x \\cdot y \\cdot z)} = 12 \\implies \\frac{\\log w}{\\log x + \\log y + \\log z} = 12\n     \\]\n  3. Given \\( \\frac{\\log w}{\\log x} = 24 \\) and \\( \\frac{\\log w}{\\log y} = 40 \\), we can solve for \\( \\log x \\) and \\( \\log y \\) in terms of \\( \\log w \\):\n     \\[\n     \\log x = \\frac{\\log w}{24}, \\quad \\log y = \\frac{\\log w}{40}\n     \\]\n  4. Substituting these into the equation \\( \\frac{\\log w}{\\log x + \\log y + \\log z} = 12 \\):\n     \\[\n     \\frac{\\log w}{\\frac{\\log w}{24} + \\frac{\\log w}{40} + \\log z} = 12\n     \\]\n  5. Simplifying the denominator:\n     \\[\n     \\frac{\\log w}{\\frac{\\log w (5 + 12)}{120} + \\log z} = 12 \\implies \\frac{\\log w}{\\frac{\\log w (17)}{120} + \\log z} = 12 \\implies \\frac{\\log w}{\\frac{\\log w}{120} + \\log z} = 12\n     \\]\n  6. Further simplification yields:\n     \\[\n     \\frac{\\log w}{\\frac{\\log w + 120 \\log z}{120}} = 12 \\implies \\frac{\\log w}{\\frac{\\log w + 120 \\log z}{120}} = 12 \\implies 12 \\cdot \\frac{120 \\log z}{\\log w + 120 \\log z} = 12 \\implies 1440 \\log z = 12 \\cdot \\log w + 1440 \\log z\n     \\]\n  7. Solving for \\( \\log z \\):\n     \\[\n     1440 \\log z = 12 \\cdot \\log w + 1440 \\log z \\implies 1440 \\log z - 1440 \\log z = 12 \\cdot \\log w \\implies 0 = 12 \\cdot \\log w \\implies \\log w = 0\n     \\]\n  8. Since \\( \\log w = 0 \\), we have \\( w = 1 \\). However, this contradicts the given conditions that \\( w \\) is a positive number. Therefore, we must have made an error in our assumptions or calculations.\n  9. Reconsidering the problem, we realize that the correct approach is to use the given logarithmic values directly and solve for \\( \\log_z w \\).\n  -/\n  -- Ensure that the logarithmic values are correctly computed\n  have : Real.log x \u2260 0 := by\n    intro h\n    rw [h] at h0\n    norm_num at h0\n  have : Real.log y \u2260 0 := by\n    intro h\n    rw [h] at h1\n    norm_num at h1\n  have : Real.log z \u2260 0 := by\n    intro h\n    rw [h] at h2\n    norm_num at h2\n  -- Simplify the logarithmic expressions using field operations\n  field_simp at h0 h1 h2 \u22a2\n  -- Use linear arithmetic to solve for the desired logarithmic value\n  nlinarith"

response = client.verify([
    {"proof": code1, "custom_id": "1" } ,
    {"proof": code2, "custom_id": "2" } ,
    {"proof": code3, "custom_id": "3" } ,
    {"proof": code4, "custom_id": "4" } ,
    {"proof": code5, "custom_id": "5" } ,
    {"proof": code6, "custom_id": "6" } ,
    {"proof": code7, "custom_id": "7" } ,

], timeout=30)

def change_result(results):
    transformed_results = []
    for item in results:

        response = item["response"]
        messages = response["messages"]
        
        transformed = {
            "custom_id" : item['custom_id'],
            "complete": (not any(m["severity"] == "error" for m in messages) and 
                        not any("sorry" in m.get("data", "") for m in messages) and
                        not any("failed" in m.get("data", "") for m in messages if m["severity"] == "warning"))
        }

        
        transformed_results.append(transformed)

    return transformed_results

# Transform the verification results
compilation_results = change_result(response['results'])
print(compilation_results)

